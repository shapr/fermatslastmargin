with (import ./nix/default.nix {});

rec {
  inherit pkgs;
  inherit hsPkgs;

  fermatslastmargin = hsPkgs.fermatslastmargin.overrideAttrs (old: rec {
    buildInputs = (old.buildInputs or []) ++ [ pkgs.makeWrapper ];

    patches = [ ./nix/github.patch ];
    # get pdftocairo in PATH
    postInstall = ''
      wrapProgram $out/bin/fermatslastmargin --prefix PATH : ${pkgs.lib.makeBinPath [ pkgs.poppler_utils ]}
    '';
  });
}
